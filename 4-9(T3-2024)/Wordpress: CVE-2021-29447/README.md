Link room: https://tryhackme.com/room/wordpresscve202129447

# ENUMERATING
## using nmap
![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/51f4936a-934c-42a3-a528-4cf09f752ccf)

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/152259d7-cbe6-4484-b675-ea4a8986127d)

=> wordpress 5.6.2 .and mysql 5.7.33
## using ffuf

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/21e3f950-fa92-4261-bd4a-f8ab1744b15a)
# EXPLOITING

## With introduction
### create files
I create payload.wav and poc.dtd files

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/ec8489bf-f154-4453-9328-aa08cd593fe3)

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/9a9a9fa7-e0e1-49da-bfbc-d9f447519774)

Then, I login wordpress with username: ```test-corp``` and passwd: ```test```

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/f491293b-ac29-4e84-8705-eb24086bcd1a)

## upload wav file
+ in my kali machine, 

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/73133ace-b61a-4666-95c6-468897f7ae7a)

Then, I upload payload.wav to wordpress

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/417c7a1d-ff5c-43d5-b0df-0a29184a98f3)

I get a hash code

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/fa1b6865-5f3f-4cdc-9958-3880861cb661)

Actually, I can use cyberchef website to crack it. But I follow introduction and use php to decode: ```<?php echo zlib_decode(base64_decode('base64here')); ?>```

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/6e479515-2361-43a7-a7e4-c94f43849e8d)

=> It's worked.So, I replace poc.dtd ```resource=/var/www/html/wp-config.php``` and I get a new hash code

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/18dd0a1c-9133-4e70-a71a-9b9eff81b36d)

I continue to crack it and I can read wp-config.php file

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/2c40cab8-7bce-42ef-8164-226594178264)

Using this information, I connect to mysql and get authentication .

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/6675b64a-5215-4b8d-adc7-58a3e71f093e)

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/50aac4c3-3987-4719-95dc-38c02d6baf09)

I use john the ripper to crack hashcode

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/451673fb-8b7e-4b75-85bf-6e44a8b73941)

=> I login wordpress with this authentication
![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/47187e59-4385-459f-b2c2-c0892c7d547f)

I try upload "php_reverse_shell.php" at media but it's fail. So , I upload it at plugins - add news.

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/86cfa8f9-d892-48d1-b120-fe71d1e08dba)

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/7ff3507f-02c1-403a-89eb-8ce136d9addc)

Now, I only need to run ```nc``` and this path.

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/ab931906-00a3-4dde-ad5d-a8a2c0ed9092)

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/429677aa-40f1-41ab-85e5-8f1a6e4e9866)

=> Nice! I get a reverse shell.

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/119b9006-f398-48b4-b055-679ff7d57124)

![image](https://github.com/nguyenngocdung18/tryhackme/assets/134156226/fd857da9-e1b8-4ffb-a405-b6c6be08eb8c)

=> flag.txt
# Done!!!
Thanks for reading. Bye!
